<SCRIPT LANGUAGE='JavaScript' SRC='/shares/js/plug-in/jquery.form.js'></SCRIPT>      <script type='text/javascript'> window.onbeforeunload   =   function()   {//alert('====================');//return '';}window.onunload   =   function()   {//alert('====================');//return false;}function a(){alert('');}</script>  <script type='text/javascript'>      $(function() {            // 提交前	function showRequest(formData, jqForm, options) { 			  				  return true;				  				  }                  					function showResponse(responseText, statusText)  {               		      			  $('#msg').html(responseText);			               }     if (($('#id').val())!=''){    //$('#diningtableid').hide();	//$('#diningtableid').after($('<div>'+$('#diningtableid').val()+'</div>'));	}	   $('#btn-save').click(function() {    if(Number($('#Count').val())==0)     {	 alert('您还没有选择商品!');	 return('');	 }		r=window.confirm('提交定单,要继续吗？');	  if (r ==false){	  return;	  }	  	 if (($('#id').val())!=''){     	 	  $('#f1j-form').attr('action','saveOrderByAndroid.do');	    	        //alert($('#id').val());	    }    else    {	 	  $('#f1j-form').attr('action','createOrderByAndroid.do');	    	       }     if (!validForm()){return('');}   		var options = {             		  //target:        '#output1',   // 用服务器返回的数据 更新 id为output1的内容.	       					   beforeSubmit:  showRequest,  // 提交前							   url:'createOrderByAndroid.do',				        success:       showResponse,  // 提交后 				        				        resetForm: false       				       				    };				        	  	 $('#f1j-form').ajaxForm(options); 		 	 	 $('#f1j-form').submit();	});	// ==============加单 ===========================	$('#btn-add').click(function() {         	      if(Number($('#Count').val())==0)     {	 alert('您还没有选择商品!');	 return('');	 }		r=window.confirm('提交定单,要继续吗？');	  if (r ==false){	  return;	  }	 //alert($('#ordernu').val());	 $('#id').val($('#ordernu').val());     //$('#f1j-form').attr('action','appendOrderByAndroid.do');	    	   	 var options = {             		  //target:        '#output1',   // 用服务器返回的数据 更新 id为output1的内容.	       					   beforeSubmit:  showRequest,  // 提交前							   url:'appendOrderByAndroid.do',				        success:       showResponse,  // 提交后 				        				        resetForm: false       				       				    };				        	  	 $('#f1j-form').ajaxForm(options); 		 	      $('#f1j-form').submit();	});	// ==============加单 ok===========================	 $('#tableData').click(function() {         	  	 $('#tableData').sumRow({colmuns:[{index:3,type:'count'},{index:4,type:'value'}],index:5,edit:true});        $('#tableData').sum({colmuns:[{index:3,type:'count'},{index:4,type:'value'}],render: '#sumprice1',edit:true});        $('#tableData').sum({colmuns:[{index:3,type:'value'}],render: '#sumtest1',edit:true});  	 });	}); function add(id,title,count,price){   $a=$('#tableData tr td:nth-child(2) :nth-child(1)');   //alert($a.length);   for(var i=0;i<$a.length;i++){ 		   $input =$($a[i]);		   //alert($input.val());		   if (id==$input.val()){	        alert('您已经购买该菜品!如果您想修改菜品数量,请删除该菜品重新购买!');	   			return;		   }	      }    //$('#tableData')   //alert('===');  //alert(id+title);  $('#tableData').addTr({colmuns:colmuns,data:[{id_:id,title_:title},count,price,'0','-'],count:'Count'});       //$('#tableData').sum({colmuns:[{index:5,type:'value'},{index:4,type:'count'},{index:6,type:'percent'}],  //render: '#sumprice2',edit:true});  $('#tableData').sumRow({colmuns:[{index:3,type:'count'},{index:4,type:'value'}],index:5,edit:true});     $('#tableData').sum({colmuns:[{index:3,type:'count'},{index:4,type:'value'}],render: '#sumprice1',edit:true});     $('#tableData').sum({colmuns:[{index:3,type:'value'}],render: '#sumtest1',edit:true});   }var colmuns=  [{title:'项目',id:'dishid',type:'combox',copy:'type',format:'1',css:'a'},  {title:'数量',id:'dishcount',type:'text',format:'1',css:{width:'50px'},value:'1'},  {title:'金额',id:'price',type:'text',format:'1',css:{width:'50px'}},  {title:'合计',id:'sumrow',type:'text',format:'1',css:{width:'50px'}}  ];  $(document).ready(function(){ $('#tableData').addRow(  {colmuns:colmuns,data:$details0,count:'Count',msgRender:'#msg'});    $('#tableData').sum({colmuns:[{index:5,type:'value'},{index:4,type:'count'},{index:6,type:'percent'}],  render: '#sumprice2',edit:true});  $('#tableData').sumRow({colmuns:[{index:3,type:'count'},{index:4,type:'value'}],index:5,edit:true});     $('#tableData').sum({colmuns:[{index:3,type:'count'},{index:4,type:'value'}],render: '#sumprice1',edit:true});     $('#tableData').sum({colmuns:[{index:3,type:'value'}],render: '#sumtest1',edit:true});   }); </SCRIPT><div style='display:none'><select id='type'>#foreach( $name in $dish )		<option value='$name.universalid'>$name.name</option>#end</select></div><input type='hidden' value='loadFanOrder.do'  name='action'> <input type='hidden' value='0'  name='Count'  id='Count'> <input type='hidden' value='1'  name='status'> <div style='height:39px;background:url(/fan/images/order-header.gif) no-repeat bottom;'></div><div style='height:420px;background:url(/fan/images/order-bg.gif) no-repeat bottom;overflow-y:auto;padding:10px;'><div style='height:350px;no-repeat bottom;overflow-y:auto' style='margin:2px;'><div id='msg'></div><table border='0' id='tableData' cellspacing='1' cellpadding='0' width='100%'></table></div><center><div style='margin:auto 55px;background:url(/fan/images/bg_kuang01.gif) no-repeat;clear:both;border:0px solid #000;height:20px;'>数量:<span id='sumtest1'>load...</span></div><div style='margin:auto 55px;background:url(/fan/images/bg_kuang02.gif) no-repeat;clear:both;border:0px solid #000;height:20px;'>价格:￥<span id='sumprice1'>Load...</span></div><div> <img src='/fan/images/btn_clear.jpg' id='btn-clear' style='cursor:pointer'><img src='/fan/images/btn_next.jpg' id='btn-save' style='cursor:pointer'></div></center></div><div class='panel' title='定单基本信息'><table border='0' cellspacing='2' cellpadding='0' width='100%'>		<tr>				<td ><label>餐桌</label></td>		<td class='detail'>${workItem.diningtableid}</td>		<td ><label>会员</label></td>		<td class='detail'>${workItem.member}</td>	</tr>	    </table></div><div class='panel' title='加菜'> <center> <span id='ordernu-info'>选择定单</span><input type='hidden' name='ordernu' id='ordernu' value=''><input type='button' onclick='dListForId('FANORDER1','1','ordernu')' value='.' class='eform-btn-select'> </td> <img src='/fan/images/btn_next.jpg' id='btn-add' style='cursor:pointer'> </center> </div>